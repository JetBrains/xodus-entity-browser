plugins {
    id "com.moowork.node" version "1.2.0"
}

node {
    version = '7.7.3'
}

task runNpm(type: NpmTask, dependsOn: 'npmInstall') { args = ['run', 'build'] }

task webContent(type: Copy, dependsOn: 'runNpm') {
    from 'dist'
    into 'build/content/entity/browser/static'
}

task jarFrontend(type: Jar, dependsOn: 'webContent') {
    from 'build/content'
}

artifacts {
    compile file: jarFrontend.archivePath, builtBy: jarFrontend
}

clean {
    delete 'dist'
    delete 'build'
}

idea {
    module {
        // make Idea mark some dirs as excluded on module import
        excludeDirs += [file('node_modules'), file('dist'), file('.tmp')]
    }
}
